# 📊 Weekly Assessments Analyzer v3.7

تطبيق ويب متقدم لتحليل التقييمات الأسبوعية وإنشاء تقارير مفصلة للطلاب بصيغة عربية كاملة.

## ✨ الميزات الرئيسية

### 📁 معالجة الملفات
- ✅ تحميل ملفات Excel متعددة (.xlsx و .xls)
- ✅ اختيار أوراق عمل محددة من الملف
- ✅ معالجة تلقائية لأسماء الأوراق (المادة + المستوى + الشعبة)
- ✅ دعم كامل للنصوص العربية

### 📊 التحليل والإحصائيات
- ✅ حساب نسبة الإنجاز لكل طالب
- ✅ تصنيف الطلاب في 5 فئات (البلاتينية، الذهبي، الفضي، البرونزي، يحتاج تحسين)
- ✅ توصيات مخصصة لكل فئة
- ✅ رصد التقييمات المفقودة
- ✅ تصفية حسب نطاق التواريخ

### 📈 الرسوم البيانية
- ✅ توزيع الفئات (بياني عمودي)
- ✅ توزيع نسبة الإنجاز (رسم بياني)
- ✅ أكثر 10 طلاب لديهم تقييمات متبقية
- ✅ إحصائيات متقدمة

### 📄 التقارير
- ✅ تقارير HTML فردية لكل طالب (جاهزة للطباعة كـ PDF)
- ✅ تصميم عربي RTL احترافي
- ✅ تحميل جماعي كملف ZIP

### 📧 البريد الإلكتروني (جديد!)
- ✅ تقارير وصفية حسب المادة
- ✅ تحديد الطلاب غير الفاعلين تلقائياً
- ✅ إرسال مباشر للمعلمين
- ✅ دعم Gmail و Outlook و Yahoo

---

## 🚀 البدء السريع

### المتطلبات
```
Python 3.11+
pip (مدير الحزم)
اتصال إنترنت
```

### التثبيت المحلي
```bash
# 1. استنسخ المستودع
git clone https://github.com/saharred/weekly-assessments-analyzer.git
cd weekly-assessments-analyzer

# 2. أنشئ بيئة افتراضية
python3 -m venv venv

# Windows
venv\Scripts\activate

# Mac/Linux
source venv/bin/activate

# 3. ثبّت المتطلبات
pip install -r requirements.txt

# 4. شغّل التطبيق
streamlit run app.py
```

### الوصول عبر الويب
```
https://share.streamlit.io/saharred/weekly-assessments-analyzer/main/app.py
```

---

## 📋 صيغة الملف المدعومة

### بنية الملف
```
الصف 1: ...
الصف 3: ... | تاريخ 1 | تاريخ 2 | تاريخ 3 | ...
الصف 5: اسم الطالب 1
الصف 6: اسم الطالب 2
...
```

### الأعمدة
- **العمود A**: أسماء الطلاب (من الصف 5 فما فوق)
- **العمود H**: بداية أسماء التقييمات (من الصف 1 فما فوق)
- **الصف 3**: تواريخ استحقاق التقييمات

### اسم الورقة
صيغة القالب: `المادة المستوى الشعبة`

**أمثلة:**
- `التربية الاسلامية 01 6`
- `الرياضيات 02 5`
- `اللغة العربية 01 A`

---

## 🎯 قيم البيانات في الخلايا

### قيم معترف بها
- **M**: تقييم مفقود (لم يتم التسليم)
- **I**, **AB**, **X**: تُُتجاهل (لا تُحتسب)
- **أي قيمة أخرى**: تُعتبر محلولة ✅

### مثال
```
الطالب A: M, 1, 2, I, M → 
  - إجمالي: 3
  - منجز: 1
  - متبقي: 2
  - نسبة: 33.33%
```

---

## 🏆 نظام الفئات والتوصيات

| الفئة | النسبة | التوصية |
|------|--------|---------|
| 🏆 البلاتينية | ≥ 90% | أشكرك يا بطل على تميزك |
| 🥇 الذهبي | ≥ 80% | أداء جيد جدًا، حل جميع التقييمات... |
| 🥈 الفضي | ≥ 70% | أداء جيد، حل جميع التقييمات... |
| 🥉 البرونزي | ≥ 60% | لديك الكثير من التقييمات لم يتم حلها... |
| ⚠️ يحتاج تحسين | < 60% | اجتهد أكثر، هناك فرصة للوصول... |

### حالة خاصة
إذا كان لدى الطالب تقييمات لم يحلها جميعاً:
> "لم يتم حل التقييمات الأسبوعية، حاول وستجد الرحلة ممتعة"

---

## ⚙️ الإعدادات القابلة للتخصيص

في الشريط الجانبي يمكنك تعديل:

1. **عمود التقييمات** (افتراضي: H)
2. **عمود أسماء الطلاب** (افتراضي: A)
3. **صف أسماء الطلاب** (افتراضي: 5)
4. **صف تواريخ الاستحقاق** (افتراضي: 3)
5. **نطاق التواريخ** (اختياري)

---

## 🔍 التصفية والبحث

### خيارات التصفية المتقدمة
- اختيار المواد
- اختيار الفئات
- تحديد الحد الأدنى لنسبة الإنجاز

### نوع التقرير
- جميع الطلاب
- الطلاب المصفاة (بناءً على الخيارات أعلاه)
- فئة محددة

---

## 📊 جدول النتائج

| العمود | الوصف |
|--------|--------|
| اسم الطالب | من العمود A |
| المادة | من اسم الورقة |
| المستوى | من اسم الورقة |
| الشعبة | من اسم الورقة |
| تقييمات منجزة | عدد التقييمات المحلولة |
| تقييمات متبقية | عدد التقييمات المفقودة (M) |
| عدد غير منجزة | إجمالي التقييمات المفقودة |
| عناوين غير منجزة | أسماء التقييمات المفقودة |
| نسبة الإنجاز % | النسبة المئوية |
| الفئة | التصنيف |
| التوصية | رسالة مخصصة |

---

## 📧 إرسال البريد الإلكتروني

### خطوات سهلة:

#### Gmail (الموصى به):
```
1. فعّل المصادقة الثنائية
2. أنشئ App Password
3. في التطبيق:
   - خادم: smtp.gmail.com
   - البريد: your-email@gmail.com
   - كلمة المرور: [App Password]
```

#### بريد آخر:
اقرأ EMAIL_GUIDE.md للتفاصيل الكاملة

---

## 📚 ملفات التوثيق

- **README.md** - هذا الملف
- **QUICKSTART.md** - البدء السريع (5 دقائق)
- **EMAIL_GUIDE.md** - دليل البريد الإلكتروني
- **NEW_FEATURES.md** - الميزات الجديدة
- **DEPLOYMENT.md** - دليل النشر
- **TESTING.md** - دليل الاختبار

---

## 🌐 النشر على Streamlit Cloud

### الخطوات
1. اضغط على GitHub
2. اذهب إلى [Streamlit Cloud](https://streamlit.io/cloud)
3. انقر "New app"
4. اختر:
   - Repository: `saharred/weekly-assessments-analyzer`
   - Branch: `main`
   - Main file path: `app.py`
5. انقر "Deploy"

---

## 🛠️ استكشاف الأخطاء

### المشكلة: "لم أجد أسماء تقييمات"
**الحل**: تأكد من:
- أسماء التقييمات موجودة في الصف 1
- تبدأ من العمود H
- لا تكون فارغة أو "OVERALL"

### المشكلة: "لم أجد خلية عنوان الطلاب"
**الحل**: تأكد من:
- أسماء الطلاب تبدأ من الخلية A5
- الصيغة صحيحة (عمود A، صف 5)

### المشكلة: التواريخ لا تعمل
**الحل**: استخدم صيغ التاريخ المدعومة:
- `YYYY-MM-DD`
- `DD-MM-YYYY`
- `DD/MM/YYYY`
- `DD.MM.YYYY`

---

## 📞 الدعم والمساهمة

### الدعم الفني
- 📧 البريد الإلكتروني
- 🐛 GitHub Issues
- 💬 Discussions
- 📖 التوثيق الشاملة

### المساهمة
```bash
1. Fork المستودع
2. أنشئ feature branch
3. عمل commit
4. Push و Create PR
```

---

## 📄 الترخيص والملكية
```
MIT License
تحت السيطرة الكاملة لـ saharred

المتطلبات مفتوحة المصدر:
- Pandas: BSD
- Streamlit: Apache 2.0
- Matplotlib: PSF
- OpenPyXL: MIT
```

---

## 🎯 الأهداف المستقبلية

### قصيرة المدى (1-2 شهر)
- [ ] تصدير PDF مباشر
- [ ] جدولة التقارير
- [ ] إشعارات بالبريد الإلكتروني

### طويلة المدى (3-6 أشهر)
- [ ] تطبيق موبايل
- [ ] API REST
- [ ] لوحة تحكم متقدمة
- [ ] تحليل متقدم (تنبؤات)
- [ ] دعم لغات إضافية

---

## 💡 ملاحظات التطوير

### أفضل الممارسات المتبعة
1. ✅ فصل المنطق عن الواجهة
2. ✅ معالجة الأخطاء الشاملة
3. ✅ توثيق الكود والدوال
4. ✅ الالتزام بـ PEP 8
5. ✅ اختبار شامل

---

**تاريخ الإصدار: يناير 2025**
**النسخة: 3.7**
**الحالة: جاهز للاستخدام الفوري! 🚀**
